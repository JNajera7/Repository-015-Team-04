<link rel="stylesheet" href="../../public/css/style.css">

<div class="container" id="savedPiecesContainer">

    <!-- Navbar + Page Title -->
    <h1>Saved Pieces</h1>

    <!-- Add/Remove form modal/overlay -->
    <div id="overlay" class="modal" style="display:none; margin-left: 33%"> 
        <h2 id="formName"></h2>

        <!-- Add Piece Form -->
        <form action="/savedpieces" method="POST" id="addPieceForm" style="display:none">

            <!-- Photo Upload -->
            <label for="newPiecePhoto">Upload Photo:</label>
            <input type="file" id="newPiecePhoto" accept="image/*" required> <br><br>

            <!-- Piece Name textbox -->
            <label for="pieceName">Piece Name:</label>
            <input type="text" id="pieceName">

            <!-- Catergory radio button select (can only pick one) -->
            <label>Piece Catergory:</label> <br>
                <input type="radio" id="topRadioButton" name="pieceType" value="top" onchange="toggleDropContents('topSubcat')" required>
                <label for="topRadioButton">Top</label><br>
                <input type="radio" id="bottomRadioButton" name="pieceType" value="bottom" onchange="toggleDropContents('bottomSubcat')">
                <label for="bottomRadioButton">Bottom</label><br>
                <input type="radio" id="fullbodyRadioButton" name="pieceType" value="fullbody" onchange="toggleDropContents('fullbodySubcat')">
                <label for="fullbodyRadioButton">Full-Body</label><br>
                <input type="radio" id="footwearRadioButton" name="pieceType" value="footwear" onchange="toggleDropContents('footwearSubcat')">
                <label for="footwearRadioButton">Footwear</label><br>
                <input type="radio" id="accessoryRadioButton" name="pieceType" value="accessory" onchange="toggleDropContents('accessorySubcat')">
                <label for="accessoryRadioButton">Accessory</label><br>
                <input type="radio" id="outerwearRadioButton" name="pieceType" value="outerwear" onchange="toggleDropContents('outerwearSubcat')">
                <label for="outerwearRadioButton">Outerwear</label><br>
            <br>

            <!-- Piece Subcatergories (multiple selectable) -->
            <label id="subcatTitle">Piece Subcatergory:</label> <br>
                <div class="container" id="topSubcat" style="display:none">
                    <input type="radio" id="shortSleeveSelect" name="topType" value="shortSleeve" required>
                    <label for="shortSleeveSelect">Short Sleeve</label><br>
                    <input type="radio" id="longSleeveSelect" name="topType" value="longSleeve">
                    <label for="shortSleeveSelect">Long Sleeve</label><br>
                    <input type="radio" id="sweaterSelect" name="topType" value="sweater">
                    <label for="sweaterSelect">Sweater</label><br>
                </div>

                <div class="container" id="bottomSubcat" style="display:none">
                    <input type="radio" id="shortsSelect" name="bottomType" value="shorts" required>
                    <label for="shortsSelect">Shorts</label><br>
                    <input type="radio" id="pantsSelect" name="bottomType" value="pants">
                    <label for="pantsSelect">Pants</label><br>
                    <input type="radio" id="skirtSelect" name="bottomType" value="skirt">
                    <label for="skirtSelect">Skirt</label><br>
                </div>

                <div class="container" id="fullbodySubcat" style="display:none">
                    <input type="radio" id="onepieceSelect" name="fullbodyType" value="onepiece" required>
                    <label for="onepieceSelect">One-Piece</label><br>
                    <input type="radio" id="dressSelect" name="fullbodyType" value="dress">
                    <label for="dressSelect">Dress</label><br>
                </div>

                <div class="container" id="accessorySubcat" style="display:none">
                    <input type="radio" id="jewelrySelect" name="accessoryType" value="jewelry" required>
                    <label for="jewelrySelect">Jewelry</label><br>
                    <input type="radio" id="headwearSelect" name="accessoryType" value="headwear">
                    <label for="headwearSelect">Headwear</label><br>
                    <input type="radio" id="socksSelect" name="accessoryType" value="socks">
                    <label for="socksSelect">Socks</label><br>
                    <input type="radio" id="eyewearSelect" name="accessoryType" value="eyewear">
                    <label for="eyewearSelect">Eyewear</label><br>
                </div>

                <div class="container" id="outerwearSubcat" style="display:none">
                    <input type="radio" id="coatSelect" name="outerwearType" value="coat" required>
                    <label for="coatSelect">Coat</label><br>
                    <input type="radio" id="jacketSelect" name="outerwearType" value="jacket">
                    <label for="jacketSelect">Jacket</label><br>
                    <input type="radio" id="vestSelect" name="outerwearType" value="vest">
                    <label for="vestSelect">Vest</label><br>
                </div>

            <br><br>

            <label>Style:</label> <br>
                <input type="checkbox" id="casual">
                <label for="casual">Casual</label><br>
                <input type="checkbox" id="formal">
                <label for="formal">Formal</label><br>
                <input type="checkbox" id="athletic">
                <label for="athletic">Athletic</label><br>
                <input type="checkbox" id="party">
                <label for="party">Party</label><br>
                <input type="checkbox" id="warm">
                <label for="warm">Warm</label><br>
                <input type="checkbox" id="rain">
                <label for="rain">Rain</label><br>
                <input type="checkbox" id="snow">
                <label for="snow">Snow</label><br>
                <input type="checkbox" id="fancy">
                <label for="fancy">Fancy</label><br>
                <input type="checkbox" id="office">
                <label for="office">Office</label><br>
                <!-- TODO: potentially add an add-your-own catergory? -->
            <br>

            <!-- Implement with weather stuff. rn defaults to submitting "" in index.js
            <label>Warmth:</label> -->

            <label>Color:</label> <br>
                <input type="checkbox" id="red">
                <label for="red">Red</label><br>
                <input type="checkbox" id="orange">
                <label for="orange">Orange</label><br>
                <input type="checkbox" id="yellow">
                <label for="yellow">Yellow</label><br>
                <input type="checkbox" id="green">
                <label for="green">Green</label><br>
                <input type="checkbox" id="blue">
                <label for="blue">Blue</label><br>
                <input type="checkbox" id="purple">
                <label for="purple">Purple</label><br>
                <input type="checkbox" id="black">
                <label for="black">Black</label><br>
                <input type="checkbox" id="white">
                <label for="white">White</label><br>
                <input type="checkbox" id="gray">
                <label for="gray">Gray</label><br>
            <br>

            <label>Pattern:</label> <br>
                <input type="checkbox" id="plaid">
                <label for="plaid">Plaid</label><br>
                <input type="checkbox" id="polka">
                <label for="polka">Polka-Dotted</label><br>
                <input type="checkbox" id="camo">
                <label for="camo">Camo</label><br>
                <input type="checkbox" id="graphic">
                <label for="graphic">Graphic</label><br>
            <br>

            <input type="submit" value="Add" id="submitAdd">
            <input type="reset" value="Cancel" id="cancelAdd" onclick="toggleVisibility('addPieceForm')"/>
        </form>
    </div>

    <!-- TODO: use a foreach handlebar to populate with the images of clothes that are uploaded
        in their correct catergories, from database table.
    https://www.geeksforgeeks.org/how-to-add-image-into-dropdown-list-for-each-items/ -->
    <div class="container" style="display: inline-block">
        <!-- Top Dropdown -->
        <div class="container" id="topDrop">
            <button class="button" id="topDropButton" onclick="toggleDropContents('topDropContent')"> Tops </button>
            <br>
            <div class="dropdown-content" id="topDropContent" style="display:none">
                <!-- Loop through each piece in the tops category -->
                {{#each top}}
                    <div class="card">
                        <img src="{{imgFile}}" alt="{{name}}" class="card-img-top">
                        <div class="card-body">
                            <h5 class="card-title">{{name}}</h5>
                        </div>
                    </div>
                {{/each}}
            </div>
        </div> <br>

        <!-- Bottoms Dropdown -->
        <div class="container" id="bottomDrop">
            <button class="button" id="bottomDropButton" onclick="toggleDropContents('bottomDropContent')"> Bottoms </button>
            <br>
            <div class="dropdown-content" id="bottomDropContent" style="display:none">  
                <!-- Loop through each piece in the bottoms category -->
                {{#each bottoms}}
                    <div class="card">
                        <img src="{{imgFile}}" alt="{{name}}" class="card-img-top">
                        <div class="card-body">
                            <h5 class="card-title">{{name}}</h5>
                        </div>
                    </div>
                {{/each}}
            </div>
        </div> <br>

        <!-- Full-Body Pieces Dropdown -->
        <div class="button" id="fullbodyDrop">
            <button class="dropdown" id="fullbodyDropButton" onclick="toggleDropContents('fullbodyDropContent')"> Full-Body </button>
            <br>
            <div class="dropdown-content" id="fullbodyDropContent" style="display:none"> 
                <!-- Loop through each piece in the fullbody category -->
                {{#each fullbody}}
                    <div class="card">
                        <img src="{{imgFile}}" alt="{{name}}" class="card-img-top">
                        <div class="card-body">
                            <h5 class="card-title">{{name}}</h5>
                        </div>
                    </div>
                {{/each}}
            </div>
        </div> <br>

        <!-- Footwear Dropdown -->
        <div class="container" id="shoesDrop">
            <button class="dropdown" id="footwearDropButton" onclick="toggleDropContents('footwearDropContent')"> Footwear </button>
            <br>
            <div class="dropdown-content" id="footwearDropContent" style="display:none">  
                <!-- Loop through each piece in the footwear category -->
                {{#each footwear}}
                    <div class="card">
                        <img src="{{imgFile}}" alt="{{name}}" class="card-img-top">
                        <div class="card-body">
                            <h5 class="card-title">{{name}}</h5>
                        </div>
                    </div>
                {{/each}}
            </div>
        </div> <br>
        

        <!-- Accessories Dropdown -->
        <div class="button" id="accessoryDrop">
            <button class="dropbtn" id="accessoryDropButton" onclick="toggleDropContents('accessoryDropContent')"> Accessories </button>
            <br>
            <div class="dropdown-content" id="accessoryDropContent" style="display:none">
                <!-- Loop through each piece in the tops category -->
                {{#each accessory}}
                    <div class="card">
                        <img src="{{imgFile}}" alt="{{name}}" class="card-img-top">
                        <div class="card-body">
                            <h5 class="card-title">{{name}}</h5>
                        </div>
                    </div>
                {{/each}}
            </div>
        </div>

        <!-- Outerwear Dropdown -->
        <div class="button" id="outerwearDrop">
            <button class="dropbtn" id="outerwearDropButton" onclick="toggleDropContents('outerwearDropContent')"> Outerwear </button>
            <br>
            <div class="dropdown-content" id="outerwearDropContent" style="display:none">
                <!-- Loop through each piece in the tops category -->
                {{#each outerwear}}
                    <div class="card">
                        <img src="{{imgFile}}" alt="{{name}}" class="card-img-top">
                        <div class="card-body">
                            <h5 class="card-title">{{name}}</h5>
                        </div>
                    </div>
                {{/each}}
            </div>
        </div>

        <br><br>
    </div>
    <!-- Adding and Removing Piece Form Buttons -->
    <footer>
        <button class="button" id="addPiece" onclick="toggleVisibility('addPieceForm')"> Add Piece </button>
        <button class="button" id="removePiece" action="/delete" method="GET"> Remove Piece </button>
    </footer>
</div>

<!-- Implementing JS function calls -->
<script>
    /*
        Toggling visibility of add/remove piece forms for savedpieces.hbs
            formId: string -- id of the form that will have its visibility toggled
    */
    function toggleVisibility(formId) {

        var form = document.getElementById(formId);
        var overlay = document.getElementById("overlay");
        var formName = document.getElementById("formName");
        var addButton = document.getElementById("addPiece");
        var removeButton = document.getElementById("removePiece");

        if(form.style.display === "none") {
            form.style.display = "block";
            overlay.style.display = "block";
            addButton.style.display = "none";
            removeButton.style.display = "none";
            // Makes form name legible
            var displayname = formId.replace(/([a-z])([A-Z])/g, '$1 $2');
            formName.innerHTML=displayname.substring(0,1).toUpperCase()+displayname.slice(1);
        } else {
            form.style.display = "none";
            overlay.style.display = "none";
            addButton.style.display = "inline-block";
            removeButton.style.display = "inline-block";
            formName.innerHTML=""; // Clear form name when hiding form
        }
    }

    /*
        Toggles the dropdown of a fits catergory button and displays its contents
            contentId: string -- id of the content that will have its visibility toggled underneath the button
    */
    function toggleDropContents(contentId) {
        const content = document.getElementById(contentId);
        if(content.style.display === "none") {
            content.style.display = "flex-wrap";
        } else {
            content.style.display = "none";
        }
    }
</script>